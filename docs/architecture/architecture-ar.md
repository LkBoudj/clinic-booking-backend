# وثيقة معمارية النظام

## 1. تصور معماري عالي المستوى

يتبع النظام هيكلية خلفية (Backend) معيارية باستخدام **Express.js (TypeScript)**، ويتضمن:

- **طبقة API**: المسارات، المتحكمات
- **طبقة منطق الأعمال**: الخدمات
- **طبقة الوصول إلى البيانات**: Mongoose مع MongoDB
- **طبقة التوثيق والمصادقة**: باستخدام Passport.js واستراتيجية JWT
- **تكاملات خارجية**:
  - **Stripe API** للدفع الإلكتروني الآمن
  - **WhatsApp Business API** لإرسال الإشعارات بمواعيد المرضى

## 2. التقنيات والأطر المستخدمة

| الطبقة                    | التقنية                   |
| ------------------------- | ------------------------- |
| اللغة                     | TypeScript                |
| إطار العمل                | Express.js                |
| قاعدة البيانات            | MongoDB باستخدام Mongoose |
| المصادقة                  | Passport.js مع JWT        |
| توثيق الـ API             | Swagger (OpenAPI 3.0)     |
| الدفع الإلكتروني          | Stripe API                |
| رسائل الإشعارات           | WhatsApp API              |
| الحاويات (اختياري لاحقًا) | Docker                    |

## 3. نقاط التكامل الخارجية

- **Stripe**:

  - دعم بطاقات الائتمان والخصم
  - تكامل Webhook لتتبع حالة الدفع

- **WhatsApp Business API**:
  - تأكيد مواعيد المرضى
  - إرسال تذكيرات بالمواعيد

## 4. المخططات

سيتم تضمين:

- مخطط مكونات النظام
- تدفق الحجز (Request/Response)
- مخطط تسلسلي للمصادقة (Sequence Diagram)

## 5. ملاحظات

- تم تصميم النظام مع مراعاة قابلية التوسع والفصل الوظيفي (Separation of Concerns).
- سيتم توثيق كل وحدة واختبارها بشكل مستقل.
